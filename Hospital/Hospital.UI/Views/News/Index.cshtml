@model List<Hospital.DAL.DataContext.Entities.News>

<div class="container margim_90">
    <h1 class="mb-4">Latest News</h1>

    <!-- News List -->
    <div class="row" id="newsContainer">
        @Html.Partial("_NewsItems", Model)
    </div>

    <!-- Load More -->
    <div class="row">
        <div class="col-md-12 text-center mt-3">
            <button id="loadMoreNewsBtn" class="btn btn-primary">Load More</button>
        </div>
    </div>
</div>

<script>
    let skip = @Model.Count;
    const take = 4;
    const newsContainer = document.getElementById('newsContainer');
    const loadMoreNewsBtn = document.getElementById('loadMoreNewsBtn');

    loadMoreNewsBtn.addEventListener('click', async () => {
        try {
            const response = await fetch(`@Url.Action("LoadMore", "News")?skip=${skip}&take=${take}`);
            if (response.ok) {
                const html = await response.text();
                if (html.trim() === '') {
                    loadMoreNewsBtn.style.display = 'none';
                    return;
                }
                newsContainer.insertAdjacentHTML('beforeend', html);
                skip += take;
            }
        } catch (err) {
            console.error(err);
        }
    });
</script>